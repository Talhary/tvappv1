<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drama Selection with Video Player</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/afterglow/latest/afterglow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1"></script>
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" />
    <!-- <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script> -->
    <!-- <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" /> -->
    <style>
        body{
            background-image: url('https://static.vecteezy.com/system/resources/previews/008/968/741/large_2x/multi-layers-yellow-blue-dark-texture-3d-papercut-layers-in-gradient-banner-abstract-paper-cut-art-background-design-for-website-template-topography-map-concept-or-smooth-origami-paper-cut-vector.jpg');
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }
    </style>
</head>

<body class="bg-gray-900 text-white flex flex-col justify-start items-center min-h-screen">
    <div class="w-[100vw] mx-auto  h-full max-w-xl backdrop-blur-md border border-black shadow">

        <video  playsinline controls  id="vid1"  height="300" class='video-js w-full max-w-xl mx-auto ' poster='./images/MainBefore.webp' controls title='Video 01' >
            <source id="videoSrc" src='https://cdn9.niazitv.pk/Niazi-Play/Kurulus-Season-5-Urdu-Dubbed/Episode-1.mp4/index.m3u8'
                type="video/mp4" data-quality="hd" />
        </video>
        <div class="custom-controls py-2 text-xl bg-gray-600 flex gap-x-3 items-center flex-row justify-center">
            <button id="prevBtn" class="pr-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-skip-backward-fill" viewBox="0 0 16 16">
                    <path d="M.5 3.5A.5.5 0 0 0 0 4v8a.5.5 0 0 0 1 0V8.753l6.267 3.636c.54.313 1.233-.066 1.233-.697v-2.94l6.267 3.636c.54.314 1.233-.065 1.233-.696V4.308c0-.63-.693-1.01-1.233-.696L8.5 7.248v-2.94c0-.63-.692-1.01-1.233-.696L1 7.248V4a.5.5 0 0 0-.5-.5"/>
                  </svg>
            </button>
            <button id="playBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-play-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                    <path d="M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"/>
                  </svg>
            </button>
            <button id="pauseBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-pause" viewBox="0 0 16 16">
                    <path d="M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5m4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5"/>
                  </svg>
            </button>
            <button id="nextBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-fast-forward-fill" viewBox="0 0 16 16">
                    <path d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696z"/>
                    <path d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696z"/>
                  </svg>
            </button>
           
        </div>
        <div class="flex gap-x-1 items-center px-2 justify-start bg-[#49501d]  h-20  w-full">
            <div class="flex gap-x-1 pb-5">
                <div>
                    <img src="./images/MainBefore.webp" class="rotate-[90deg] mt-5 max-w-10 object-contain rounded-full" />
                </div>
                
            </div>
            <div class=" flex gap-x-2 items-center text-sm px-1 h-20  heading">
                
                <div >
                    <h1 class="text-[0.8rem]">Powered By Fungroup</h1>
                    <input type="text" placeholder="Enter a Keyword for search" class=" px-2  py-2 my-1 text-black search-input rounded text-[0.7rem]">
                </div>
                <button class="bg-white rounded-md  search-btn text-black px-5 py-4"> Search</button>
            </div>
            <div class="select-item  hidden">
                <h3 class="name ml-2 font-semibold"></h3>
                <select name="selectVideo" id="select-ep" class="mx-2 text-black px-2 py-2 ">
                    <option value="op">Episode 1</option>
                </select>
            </div>
            <div class="btn-section hidden">
                <button class='play-btn rounded-md p-2 bg-gray-800 bg-gray-200'>Play</button>
            <button class="bg-red-500 close-btn p-2 px-4 rounded-md mx-1">x</button>
            </div>
        </div>
        <div class="section flex gap-3 p-3 flex-wrap bg-[#342520] h-full justify-center items-center">
        
        </div>
    </div>
    <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script>
    <script>
        // Get the video element
       
    </script>
    <script>
const player = videojs('vid1', {});

player.pause()









        function clearSelectOptions() {
    const selectElement = document.getElementById("select-ep");

    // Remove all options from the select element
    while (selectElement.options.length > 0) {
        selectElement.remove(0);
    }
}
        const section = document.querySelector('.section')
        let list ;
        fetch('https://sagheeronline7.000webhostapp.com/Talha.2drama.php').then(res=>res.json())
        .then(res=>{
            console.log(res)
            list = res
            console.log(res)
            res.forEach(item => {
            const div = document.createElement('div')
            div.className = 'playVideo  relative flex items-center p-1 bg-white   shadow-white justify-center min-w-20'
            div.setAttribute('data-id', item.id)
            div.innerHTML = `<div>
                    <img src="${item.imgsrc}" alt="${item.title}" class="object-contain w-[8rem]" />
                </div>
                <div class="absolute bottom-2 text-black text-center font-bold bg-white bg-opacity-60 w-fit px-1 rounded-md text-xl w-full">
                    ${item.title}
                </div>`
            div.addEventListener('click', (e) => {
                const title = document.querySelector('.name')
                document.querySelectorAll('.playVideo').forEach(el=>{
                    el.style.backgroundColor= 'white'
                })
                e.currentTarget.style.backgroundColor= 'red'
                title.textContent = item.title  
                const id  = e.currentTarget.getAttribute('data-id')
                const episodes= list.find(item => item.id == id).episodes
                const SelectOption = document.getElementById('select-ep')
                document.querySelector('.heading').classList.add('hidden')
                document.querySelector('.select-item').classList.remove('hidden')
                document.querySelector('.btn-section').classList.remove('hidden')
                clearSelectOptions()
                episodes.forEach((episode,i)=>{

                  const option  = document.createElement('option')
                  option.value = episode;
                  option.textContent = `Episode ${i+1}`
                  SelectOption.appendChild(option)
                })
            })
            section.appendChild(div)
        })
        })
        
        document.querySelector('.play-btn').addEventListener('click', () => {
    const selectOption = document.getElementById('select-ep');

    const newSrc = selectOption.value;
    player.src({ src: newSrc, type: 'video/mp4' });

  // Optionally, start playing the video automatically
  player.play();

    // Ensure the player is properly loaded with the new source
    
});
        document.querySelector('.close-btn').addEventListener('click',()=>{
            document.querySelector('.heading').classList.remove('hidden')
            document.querySelector('.select-item').classList.add('hidden')
            document.querySelector('.btn-section').classList.add('hidden')
        })
        document.querySelector('.search-btn').addEventListener('click',()=>{
             const text = document.querySelector('.search-input').value
             const filteredItems = list.filter(item => item.title.toLowerCase().includes(text.toLowerCase()))
             section.innerHTML = ''
             filteredItems.forEach(item => {
            const div = document.createElement('div')
            div.className = 'playVideo relative flex items-center p-1 bg-white bg-opacity-40 shadow shadow-md shadow-white justify-center min-w-20 '
            div.setAttribute('data-id', item.id)
            div.innerHTML = `<div>
                    <img src="${item.imgsrc}" alt="${item.title}" class="object-contain w-[8rem]" />
                </div>
                <div class="absolute bottom-2 text-black text-center font-bold bg-white bg-opacity-60 w-fit px-1 rounded-md text-xl w-full">
                    ${item.title}
                </div>`
            div.addEventListener('click', (e) => {
                const id  = e.currentTarget.getAttribute('data-id')
                const episodes= list.find(item => item.id == id).episodes
                const SelectOption = document.getElementById('select-ep')
                document.querySelector('.heading').classList.add('hidden')
                document.querySelector('.select-item').classList.remove('hidden')
                document.querySelector('.btn-section').classList.remove('hidden')
                clearSelectOptions()
                episodes.forEach((episode,i)=>{

                  const option  = document.createElement('option')
                  option.value = episode;
                  option.textContent = `Episode ${i+1}`
                  SelectOption.appendChild(option)
                })
            })
            section.appendChild(div)
        })

        })


        const video = document.getElementById('vid1');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');

        // Play the video
        playBtn.addEventListener('click', () => {
            player.play();
        });

        // Pause the video
        pauseBtn.addEventListener('click', () => {
            player.pause();
        });

        // Next video (example with static URL, should use a playlist logic for real scenario)
        nextBtn.addEventListener('click', () => {
            const selectOption = document.getElementById('select-ep');

            const newSrc = list.filter(el => {
        return el.episodes.indexOf(selectOption.value) !== -1;
    })[0].episodes;

    // Get the index of the next episode
    const nextIndex = newSrc.indexOf(selectOption.value) + 1;
    const next = newSrc[nextIndex];

    // If there's no next episode, show an alert
    if (!next) {
        alert('No More Episodes');
        return;
    }

    // Update the select option's text and value
    const nextOption = selectOption.options[selectOption.selectedIndex];
    nextOption.text = `Episode ${nextIndex + 1}`;
    selectOption.value = next;

    // Update the video player's source
    player.src({ src: next, type: 'video/mp4' });

    // Optionally, start playing the video automatically
    player.play();
        });

// Add event listener for the "Previous" button
prevBtn.addEventListener('click', () => {
    const selectOption = document.getElementById('select-ep');
    const selectedValue = selectOption.value;

    // Find the array of episodes matching the selected option's value
    const currentEpisodeObj = list.find(el => el.episodes.includes(selectedValue));
    if (!currentEpisodeObj) {
        alert('Episode list not found');
        return;
    }

    const episodes = currentEpisodeObj.episodes;

    // Find the index of the current episode
    const currentIndex = episodes.indexOf(selectedValue);

    // Calculate the index for the previous episode
    const prevIndex = currentIndex - 1;

    // Check if there is a previous episode
    if (prevIndex < 0) {
        alert('No More Episodes');
        return;
    }

    // Get the previous episode value
    const prevEpisode = episodes[prevIndex];

    // Update the select option's text and value
    selectOption.value = prevEpisode;
    selectOption.options[selectOption.selectedIndex].text = `Episode ${prevIndex + 1}`;

    // Update the video player's source
    player.src({ src: prevEpisode, type: 'video/mp4' });

    // Optionally, start playing the video automatically
    player.play();
});


    </script>
</body>

</html>